{"version":3,"file":"index.js","mappings":"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","sources":["webpack://grapesjs-rulers/webpack/universalModuleDefinition","webpack://grapesjs-rulers/webpack/bootstrap","webpack://grapesjs-rulers/webpack/runtime/define property getters","webpack://grapesjs-rulers/webpack/runtime/hasOwnProperty shorthand","webpack://grapesjs-rulers/webpack/runtime/make namespace object","webpack://grapesjs-rulers/./node_modules/@babel/runtime/helpers/esm/typeof.js","webpack://grapesjs-rulers/./node_modules/@babel/runtime/helpers/esm/toPropertyKey.js","webpack://grapesjs-rulers/./node_modules/@babel/runtime/helpers/esm/toPrimitive.js","webpack://grapesjs-rulers/./node_modules/@babel/runtime/helpers/esm/defineProperty.js","webpack://grapesjs-rulers/./src/ruler.js","webpack://grapesjs-rulers/./src/drawPoints.js","webpack://grapesjs-rulers/./src/index.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"grapesjs-rulers\"] = factory();\n\telse\n\t\troot[\"grapesjs-rulers\"] = factory();\n})(typeof globalThis !== 'undefined' ? globalThis : (typeof window !== 'undefined' ? window : this), () => {\nreturn ","// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","function _typeof(o) {\n  \"@babel/helpers - typeof\";\n\n  return _typeof = \"function\" == typeof Symbol && \"symbol\" == typeof Symbol.iterator ? function (o) {\n    return typeof o;\n  } : function (o) {\n    return o && \"function\" == typeof Symbol && o.constructor === Symbol && o !== Symbol.prototype ? \"symbol\" : typeof o;\n  }, _typeof(o);\n}\nexport { _typeof as default };","import _typeof from \"./typeof.js\";\nimport toPrimitive from \"./toPrimitive.js\";\nfunction toPropertyKey(t) {\n  var i = toPrimitive(t, \"string\");\n  return \"symbol\" == _typeof(i) ? i : i + \"\";\n}\nexport { toPropertyKey as default };","import _typeof from \"./typeof.js\";\nfunction toPrimitive(t, r) {\n  if (\"object\" != _typeof(t) || !t) return t;\n  var e = t[Symbol.toPrimitive];\n  if (void 0 !== e) {\n    var i = e.call(t, r || \"default\");\n    if (\"object\" != _typeof(i)) return i;\n    throw new TypeError(\"@@toPrimitive must return a primitive value.\");\n  }\n  return (\"string\" === r ? String : Number)(t);\n}\nexport { toPrimitive as default };","import toPropertyKey from \"./toPropertyKey.js\";\nfunction _defineProperty(e, r, t) {\n  return (r = toPropertyKey(r)) in e ? Object.defineProperty(e, r, {\n    value: t,\n    enumerable: !0,\n    configurable: !0,\n    writable: !0\n  }) : e[r] = t, e;\n}\nexport { _defineProperty as default };","/**\n * Adapted from https://github.com/MrFrankel/ruler\n */\n\nimport { drawPoints as drawPointsUtil } from './drawPoints.js';\n\nexport default class Ruler {\n    constructor(options = {}) {\n        this.api = this.builder();\n        this.utils = utils;\n        this.canvasPointerEvents = options.canvas.style.pointerEvents;\n        this.options = options;\n        this.api.constructRulers(options);\n    }\n\n    builder() {\n        let VERTICAL = 1,\n            HORIZONTAL = 2,\n            CUR_DELTA_X = 0,\n            CUR_DELTA_Y = 0,\n            SCROLL_X = 0,\n            SCROLL_Y = 0,\n            CUR_SCALE = 1;\n\n        let options,\n            rulerz = {},\n            guides = [],\n            theRulerDOM = document.createElement('div'),\n            corners = [],\n            defaultOptions = {\n                rulerHeight: 15,\n                fontFamily: 'arial',\n                fontSize: '8px',\n                strokeStyle: 'gray',\n                sides: ['top', 'left'],\n                cornerSides: ['TL'],\n                lineWidth: 1,\n                enableMouseTracking: true,\n                enableToolTip: true\n                ,\n                /* Unit settings for ruler display: 'px', 'mm', or 'cm' */\n                unit: 'mm',\n                /* CSS pixels per inch used for conversions; default 96 */\n                dpi: 96\n            };\n\n        const rotateRuler = (curRuler, angle) => {\n            const rotation = 'rotate(' + angle + 'deg)';\n            const origin = this.utils.pixelize(Math.abs(parseInt(curRuler.canvas.style.left))) + ' 100%';\n            curRuler.canvas.style.webkitTransform = rotation;\n            curRuler.canvas.style.MozTransform = rotation;\n            curRuler.canvas.style.OTransform = rotation;\n            curRuler.canvas.style.msTransform = rotation;\n            curRuler.canvas.style.transform = rotation;\n            curRuler.canvas.style.webkitTransformOrigin = origin;\n            curRuler.canvas.style.MozTransformOrigin = origin;\n            curRuler.canvas.style.OTransformOrigin = origin;\n            curRuler.canvas.style.msTransformOrigin = origin;\n            curRuler.canvas.style.transformOrigin = origin;\n        };\n\n        const positionRuler = (curRuler, alignment) => {\n            curRuler.canvas.style.left = this.utils.pixelize(-((curRuler.canvas.width / 2) - curRuler.canvas.height));\n            switch (alignment) {\n                case 'top':\n                    curRuler.orgPos = parseInt(curRuler.canvas.style.left);\n                    break;\n                case 'left':\n                    curRuler.canvas.style.top = this.utils.pixelize(-curRuler.canvas.height - 1);\n                    curRuler.orgPos = parseInt(curRuler.canvas.style.top);\n                    rotateRuler(curRuler, 90);\n                    break;\n            }\n        };\n\n        const attachListeners = (container, curRul) => {\n            const mousedown = function (e) {\n                constructGuide(curRul.dimension, e.clientX, e.clientY, e);\n            };\n\n            curRul.canvas.addEventListener('mousedown', mousedown);\n            curRul.clearListeners = function () {\n                curRul.canvas.removeEventListener('mousedown', mousedown);\n            }\n        };\n\n        const constructGuide = (dimension, x, y, e, isSet) => {\n            let guideIndex;\n            const moveCB = function (line, x, y) {\n                const coor = line.dimension === VERTICAL ? x : y;\n                if (!line.assigned()) {\n                    if (coor > options.rulerHeight) {\n                        line.assigned(true);\n                    }\n                    return;\n                }\n\n                if (coor < options.rulerHeight) {\n                    guides.some(function (guideLine, index) {\n                        if (guideLine.line === line) {\n                            guideIndex = index;\n                            return true;\n                        }\n                    });\n                    line.destroy();\n                    guides.splice(guideIndex, 1);\n                }\n            };\n\n            let guide = document.createElement('div'),\n                guideStyle = dimension === VERTICAL ? 'rul_lineVer' : 'rul_lineHor',\n                curDelta = dimension === VERTICAL ? CUR_DELTA_X : CUR_DELTA_Y;\n            guide.title = 'Double click to delete';\n            guide.dataset.id = guides.length;\n            this.utils.addClasss(guide, ['rul_line', guideStyle]);\n            guide = theRulerDOM.appendChild(guide);\n            if (dimension === VERTICAL) {\n                guide.style.left = this.utils.pixelize(x - options.container.getBoundingClientRect().left);\n                if (isSet) guide.style.left = this.utils.pixelize(Math.round(x / CUR_SCALE + options.rulerHeight - SCROLL_X));\n            } else {\n                guide.style.top = this.utils.pixelize(y - options.container.getBoundingClientRect().top);\n                if (isSet) guide.style.top = this.utils.pixelize(Math.round(y / CUR_SCALE + options.rulerHeight - SCROLL_Y));\n            }\n            guides.push({\n                dimension: dimension,\n                line: this.guideLine(guide, options.container.querySelector('.rul_wrapper'), dimension, options, curDelta, moveCB, e, CUR_SCALE)\n            });\n        };\n\n\n        const constructRuler = (container, alignment) => {\n            let canvas,\n                dimension = alignment === 'left' || alignment === 'right' ? VERTICAL : HORIZONTAL,\n                rulerStyle = dimension === VERTICAL ? 'rul_ruler_Vertical' : 'rul_ruler_Horizontal',\n                element = document.createElement('canvas');\n\n            this.utils.addClasss(element, ['rul_ruler', rulerStyle, 'rul_align_' + alignment]);\n            canvas = container.appendChild(element);\n            rulerz[alignment] = this.rulerConstructor(canvas, options, dimension);\n            rulerz[alignment].drawRuler(container.offsetWidth, options.rulerHeight);\n            positionRuler(rulerz[alignment], alignment);\n            attachListeners(container, rulerz[alignment]);\n        };\n\n        /* Helpers for unit conversions */\n        const pxPerMm = () => options.dpi / 25.4;\n        const pxToMm = px => (px / pxPerMm());\n        // formatUnit helper available per-guide inside guideLine as 'formatUnitLocal'\n\n        const constructCorner = (() => {\n            const cornerDraw = (container, side) => {\n                const corner = document.createElement('div'),\n                    cornerStyle = 'rul_corner' + side.toUpperCase();\n\n                corner.title = 'Clear Guide lines';\n                this.utils.addClasss(corner, ['rul_corner', cornerStyle, options.cornerIcon]);\n                corner.style.width = this.utils.pixelize(options.rulerHeight + 1);\n                corner.style.height = this.utils.pixelize(options.rulerHeight);\n                corner.style.lineHeight = this.utils.pixelize(options.rulerHeight);\n                return container.appendChild(corner);\n            }\n\n            function mousedown(e) {\n                e.stopPropagation();\n                clearGuides();\n            }\n\n            return function (container, cornerSides) {\n                cornerSides.forEach(function (side) {\n                    const corner = cornerDraw(container, side);\n                    corner.addEventListener('mousedown', mousedown);\n                    corner.destroy = function () {\n                        corner.removeEventListener('mousedown', mousedown);\n                        corner.parentNode.removeChild(corner);\n                    };\n                    corners.push(corner);\n                })\n            }\n\n        })();\n\n        const mouseup = (e) => {\n            guides.forEach(function (guide) {\n                guide.line.stopDrag();\n            })\n        };\n\n        const constructRulers = (curOptions) => {\n            theRulerDOM = this.utils.addClasss(theRulerDOM, 'rul_wrapper');\n            options = this.utils.extend(defaultOptions, curOptions);\n            theRulerDOM = options.container.appendChild(theRulerDOM);\n            options.sides.forEach(function (side) {\n                constructRuler(theRulerDOM, side);\n            });\n            constructCorner(theRulerDOM, options.cornerSides);\n            options.container.addEventListener('mouseup', mouseup);\n        };\n\n        const forEachRuler = (cb) => {\n            let index = 0;\n            for (let rul in rulerz) {\n                if (rulerz.hasOwnProperty(rul)) {\n                    cb(rulerz[rul], index++);\n                }\n            }\n        };\n\n        const getPos = () => {\n            return {\n                x: CUR_DELTA_X,\n                y: CUR_DELTA_Y\n            };\n        }\n\n        const setPos = (values) => {\n            let orgX = 0,\n                orgY,\n                deltaX = 0,\n                deltaY = 0;\n            forEachRuler((curRul) => {\n                if (curRul.dimension === VERTICAL) {\n                    orgY = curRul.canvas.style.top;\n                    curRul.canvas.style.top = this.utils.pixelize(curRul.orgPos + (parseInt(values.y)));\n                    deltaY = parseInt(orgY) - parseInt(curRul.canvas.style.top);\n                } else {\n                    orgX = curRul.canvas.style.left;\n                    curRul.canvas.style.left = this.utils.pixelize(curRul.orgPos + (parseInt(values.x)));\n                    deltaX = parseInt(orgX) - parseInt(curRul.canvas.style.left);\n                }\n            });\n            guides.forEach((guide) => {\n                if (guide.dimension === HORIZONTAL) {\n                    guide.line.guideLine.style.top = this.utils.pixelize(parseInt(guide.line.guideLine.style.top) - deltaY);\n                    guide.line.curPosDelta(parseInt(values.y));\n                } else {\n                    guide.line.guideLine.style.left = this.utils.pixelize(parseInt(guide.line.guideLine.style.left) - deltaX);\n                    guide.line.curPosDelta(parseInt(values.x));\n                }\n            });\n            CUR_DELTA_X = parseInt(values.x);\n            CUR_DELTA_Y = parseInt(values.y);\n        };\n\n        const setScroll = (values) => {\n            SCROLL_X = values.x;\n            SCROLL_Y = values.y;\n        }\n\n        const setScale = (newScale) => {\n            let curPos, orgDelta, curScaleFac;\n            forEachRuler(function (rul) {\n                rul.context.clearRect(0, 0, rul.canvas.width, rul.canvas.height);\n                rul.context.beginPath();\n                rul.setScale(newScale);\n                rul.context.stroke();\n                CUR_SCALE = newScale;\n            });\n\n            guides.forEach((guide) => {\n                if (guide.dimension === HORIZONTAL) {\n                    curPos = parseInt(guide.line.guideLine.style.top);\n                    orgDelta = options.rulerHeight + 1;\n                    curScaleFac = (parseFloat(newScale) / guide.line.curScale());\n                    guide.line.guideLine.style.top = this.utils.pixelize(((curPos - orgDelta - CUR_DELTA_Y) / curScaleFac) + orgDelta + CUR_DELTA_Y);\n                    guide.line.curScale(newScale);\n                } else {\n                    curPos = parseInt(guide.line.guideLine.style.left);\n                    orgDelta = options.rulerHeight + 1;\n                    curScaleFac = (parseFloat(newScale) / guide.line.curScale());\n                    guide.line.guideLine.style.left = this.utils.pixelize(((curPos - orgDelta - CUR_DELTA_X) / curScaleFac) + orgDelta + CUR_DELTA_X);\n                    guide.line.curScale(newScale);\n                }\n            });\n        };\n\n\n        const clearGuides = () => {\n            guides.forEach(function (guide) {\n                guide.line.destroy();\n            });\n            guides = [];\n        };\n\n        const removeGuide = (id) => {\n            const last = guides.length - 1;\n            [guides[id], guides[last]] = [guides[last], guides[id]];\n            guides.pop();\n        };\n\n        const toggleGuideVisibility = (val) => {\n            const func = val ? 'show' : 'hide';\n            guides.forEach(function (guide) {\n                guide.line[func]();\n            });\n        };\n\n        const toggleRulerVisibility = (val) => {\n            const state = val ? 'block' : 'none';\n            theRulerDOM.style.display = state;\n            const trackers = options.container.querySelectorAll('.rul_tracker');\n            if (trackers.length > 0) {\n                trackers[0].style.display = state;\n                trackers[1].style.display = state;\n            }\n        };\n\n        const getGuides = () => {\n            return guides.map(function (guide) {\n                return {\n                    posX: Math.round((parseInt(guide.line.guideLine.style.left) - options.rulerHeight + SCROLL_X) * CUR_SCALE),\n                    posY: Math.round((parseInt(guide.line.guideLine.style.top) - options.rulerHeight + SCROLL_Y) * CUR_SCALE),\n                    dimension: guide.dimension\n                }\n            });\n        };\n\n        const setGuides = (_guides) => {\n            if (!_guides || !_guides.length) {\n                return\n            }\n            _guides.forEach(function (guide) {\n                constructGuide(guide.dimension, guide.posX, guide.posY, null, true)\n            })\n        };\n\n        const destroy = () => {\n            clearGuides();\n            forEachRuler(function (ruler) {\n                ruler.destroy();\n            });\n            corners.forEach(function (corner) {\n                corner.destroy();\n            });\n            options.container.removeEventListener('mouseup', mouseup);\n            theRulerDOM.parentNode.removeChild(theRulerDOM);\n        };\n\n        return {\n            VERTICAL,\n            HORIZONTAL,\n            getPos,\n            setPos,\n            setScroll,\n            setScale,\n            clearGuides,\n            removeGuide,\n            getGuides,\n            setGuides,\n            constructRulers,\n            toggleRulerVisibility,\n            toggleGuideVisibility,\n            destroy\n        }\n    }\n\n    rulerConstructor(_canvas, options, rulDimension) {\n\n        let canvas = _canvas,\n            context = canvas.getContext('2d'),\n            rulThickness = 0,\n            rulLength = 0,\n            rulScale = 1,\n            dimension = rulDimension || 2,\n            orgPos = 0,\n            tracker = document.createElement('div');\n\n        const getLength = () => {\n            return rulLength;\n        };\n\n        const getThickness = () => {\n            return rulThickness;\n        };\n\n        const getScale = () => {\n            return rulScale;\n        };\n\n        const setScale = (newScale) => {\n            rulScale = parseFloat(newScale);\n            drawPoints();\n            return rulScale;\n        };\n\n        const drawRuler = (_rulerLength, _rulerThickness, _rulerScale) => {\n            rulLength = canvas.width = _rulerLength * 4;\n            rulThickness = _rulerThickness;\n            canvas.height = rulThickness * 2;\n            rulScale = _rulerScale || rulScale;\n            context.strokeStyle = options.strokeStyle;\n            context.fillStyle = options.fillStyle;\n            context.font = options.fontSize + ' ' + options.fontFamily;\n            context.lineWidth = options.lineWidth;\n            context.beginPath();\n            drawPoints();\n            context.stroke();\n        };\n\n        const drawPoints = () => {\n            drawPointsUtil(context, rulLength, rulThickness, rulScale, options);\n        };\n\n        const mousemove = (e) => {\n            let x = e.clientX, y = e.clientY;\n\n            if (e.target.tagName === 'IFRAME') {\n                const zoom = getScale() ** -1;\n                x = x * zoom + e.target.getBoundingClientRect().left;\n                y = y * zoom + e.target.getBoundingClientRect().top;\n            }\n\n            if (dimension === 2) {\n                tracker.style.left = this.utils.pixelize(x - options.container.getBoundingClientRect().left);\n            } else {\n                tracker.style.top = this.utils.pixelize(y - options.container.getBoundingClientRect().top);\n            }\n        };\n\n        const destroy = () => {\n            options.container.removeEventListener('mousemove', mousemove);\n            tracker.parentNode.removeChild(tracker);\n            this.clearListeners && this.clearListeners();\n        };\n\n        const initTracker = () => {\n            tracker = options.container.appendChild(tracker);\n            this.utils.addClasss(tracker, 'rul_tracker');\n            const height = this.utils.pixelize(options.rulerHeight);\n            if (dimension === 2) {\n                tracker.style.height = height;\n            } else {\n                tracker.style.width = height;\n            }\n            options.container.addEventListener('mousemove', mousemove);\n        };\n\n        if (options.enableMouseTracking) {\n            initTracker();\n        }\n\n        return {\n            getLength,\n            getThickness,\n            getScale,\n            setScale,\n            dimension,\n            orgPos,\n            canvas,\n            context,\n            drawRuler,\n            drawPoints,\n            destroy\n        }\n    }\n\n    /**\n     * Created by maor.frankel on 5/23/15.\n     */\n    guideLine(line, _dragContainer, lineDimension, options, curDelta, movecb, event, scale) {\n\n        let self,\n            guideLine = line,\n            _curScale = scale || 1,\n            _assigned = false,\n            _curPosDelta = curDelta || 0,\n            dragContainer = _dragContainer,\n            dimension = lineDimension || 2,\n            moveCB = movecb || function () { };\n\n        const curPosDelta = (val) => {\n            if (typeof val === 'undefined') {\n                return _curPosDelta;\n            }\n            return (_curPosDelta = val);\n        };\n\n        const assigned = (val) => {\n            if (typeof val === 'undefined') {\n                return _assigned;\n            }\n            return (_assigned = val);\n        };\n\n        const curScale = (val) => {\n            if (typeof val === 'undefined') {\n                return _curScale;\n            }\n            return (_curScale = val);\n        };\n\n        const draggable = (() => {\n            return {\n                cv: () => {\n                    return this.options.canvas;\n                },\n                move: (xpos, ypos) => {\n                    guideLine.style.left = this.utils.pixelize(xpos);\n                    guideLine.style.top = this.utils.pixelize(ypos);\n                    updateToolTip(xpos, ypos);\n                    moveCB(self, xpos, ypos);\n                },\n                startMoving: (evt) => {\n                    draggable.cv().style.pointerEvents = 'none';\n                    this.utils.addClasss(guideLine, ['rul_line_dragged']);\n                    evt = evt || window.event;\n                    let posX = evt ? evt.clientX : 0,\n                        posY = evt ? evt.clientY : 0,\n                        divTop = parseInt(guideLine.style.top || 0),\n                        divLeft = parseInt(guideLine.style.left || 0),\n                        eWi = parseInt(guideLine.offsetWidth),\n                        eHe = parseInt(guideLine.offsetHeight),\n                        cWi = parseInt(dragContainer.offsetWidth),\n                        cHe = parseInt(dragContainer.offsetHeight),\n                        cursor = dimension === 2 ? 'ns-resize' : 'ew-resize';\n\n                    options.container.style.cursor = cursor;\n                    guideLine.style.cursor = cursor;\n                    let diffX = posX - divLeft,\n                        diffY = posY - divTop;\n                    document.onmousemove = function moving(evt) {\n                        evt = evt || window.event;\n                        let posX = evt.clientX,\n                            posY = evt.clientY,\n                            aX = posX - diffX,\n                            aY = posY - diffY;\n\n                        if (aX < 0) {\n                            aX = 0;\n                        }\n                        if (aY < 0) {\n                            aY = 0;\n                        }\n\n                        if (aX + eWi > cWi) {\n                            aX = cWi - eWi;\n                        }\n                        if (aY + eHe > cHe) {\n                            aY = cHe - eHe;\n                        }\n\n                        draggable.move(aX, aY);\n                    };\n                    showToolTip();\n                },\n                stopMoving: () => {\n                    draggable.cv().style.pointerEvents = this.canvasPointerEvents;\n                    options.container.style.cursor = null;\n                    guideLine.style.cursor = null;\n                    document.onmousemove = function () { };\n                    // Keep tooltip visible after setting the guideline\n                    // hideToolTip();\n                    this.utils.removeClasss(guideLine, ['rul_line_dragged']);\n                }\n            }\n        })();\n\n        const showToolTip = (e) => {\n            if (!options.enableToolTip) {\n                return;\n            }\n            this.utils.addClasss(guideLine, 'rul_tooltip');\n        };\n\n        const updateToolTip = (x, y) => {\n            const formatUnitLocal = px => {\n                if (options.unit === 'px') return px + 'px';\n                const pxPerMmLocal = options.dpi / 25.4;\n                if (options.unit === 'cm') return `${(px / pxPerMmLocal / 10).toFixed(1).replace(/\\.0$/, '')}cm`;\n                return `${Math.round(px / pxPerMmLocal)}mm`;\n            };\n            if (y) {\n                const pxValue = Math.round((y - options.rulerHeight - 1 - _curPosDelta) * _curScale);\n                guideLine.dataset.tip = formatUnitLocal(pxValue);\n            } else {\n                const pxValue = Math.round((x - options.rulerHeight - 1 - _curPosDelta) * _curScale);\n                guideLine.dataset.tip = formatUnitLocal(pxValue);\n            }\n        };\n\n        const hideToolTip = (e) => {\n            this.utils.removeClasss(guideLine, 'rul_tooltip');\n        };\n\n        const destroy = () => {\n            draggable.stopMoving();\n            moveCB = null;\n            guideLine.removeEventListener('mousedown', mousedown);\n            guideLine.removeEventListener('mouseup', mouseup);\n            guideLine.removeEventListener('dblclick', dblclick);\n            guideLine.parentNode && guideLine.parentNode.removeChild(guideLine);\n        };\n\n        const hide = () => {\n            guideLine.style.display = 'none';\n        };\n\n        const show = () => {\n            guideLine.style.display = 'block';\n        };\n\n        const mousedown = (e) => {\n            e.stopPropagation();\n            draggable.startMoving();\n        };\n\n        const mouseup = (e) => {\n            draggable.stopMoving();\n        };\n\n        const dblclick = (e) => {\n            e.stopPropagation();\n            destroy();\n            this.api.removeGuide(guideLine.dataset.id);\n        };\n\n        guideLine.addEventListener('mousedown', mousedown);\n\n        guideLine.addEventListener('mouseup', mouseup);\n\n        guideLine.addEventListener('dblclick', dblclick);\n        if (event) {\n            draggable.startMoving(event);\n        }\n        \n        // Always show tooltip for set guidelines\n        // Use setTimeout to ensure the guideline is fully positioned\n        setTimeout(() => {\n            showToolTip();\n            const x = parseInt(guideLine.style.left || 0);\n            const y = parseInt(guideLine.style.top || 0);\n            updateToolTip(x, y);\n        }, 0);\n\n        self = {\n            setAsDraggable: draggable,\n            startDrag: draggable.startMoving,\n            stopDrag: draggable.stopMoving,\n            destroy: destroy,\n            curScale: curScale,\n            assigned: assigned,\n            curPosDelta: curPosDelta,\n            guideLine: guideLine,\n            dimension: dimension,\n            hide: hide,\n            show: show\n        };\n        return self;\n    }\n}\n\nexport const utils = {\n    extend() {\n        for (let i = 1; i < arguments.length; i++)\n            for (let key in arguments[i])\n                if (arguments[i].hasOwnProperty(key))\n                    arguments[0][key] = arguments[i][key];\n        return arguments[0];\n    },\n    pixelize(val) {\n        return val + 'px';\n    },\n    prependChild(container, element) {\n        return container.insertBefore(element, container.firstChild);\n    },\n    addClasss(element, classNames) {\n        if (!(classNames instanceof Array)) {\n            classNames = [classNames];\n        }\n\n        classNames.forEach(function (name) {\n            element.className += ' ' + name;\n        });\n\n        return element;\n    },\n    removeClasss(element, classNames) {\n        let curCalsss = element.className;\n        if (!(classNames instanceof Array)) {\n            classNames = [classNames];\n        }\n\n        classNames.forEach(function (name) {\n            curCalsss = curCalsss.replace(name, '');\n        });\n        element.className = curCalsss;\n        return element;\n    }\n}","// Configuration based on provided data\nconst config = {\n    units: 'cm',\n    dpiStandard: 96,\n    pixelsPerCm: 37.795275591,\n    pixelsPerInch: 96,\n    tickHeights: {\n        cm: 10,\n        halfCm: 8,\n        mm: 5\n    },\n    colors: {\n        background: '#f5f5f5',\n        rulerLine: '#333333',\n        tickMarks: '#000000',\n        text: '#000000'\n    },\n    font: {\n        family: 'Arial, sans-serif',\n        size: 14,\n        weight: 'normal'\n    }\n};\n\n\n/**\n * Draws ruler tick marks and labels on a canvas\n */\nexport const drawPoints = (context, rulLength, rulThickness, rulScale, options) => {\n    console.log('drawPoints called:', { rulLength, rulThickness, rulScale, unit: options.unit, dpi: options.dpi });\n    \n    // Clear the canvas with light background\n    context.fillStyle = '#f5f5f5';\n    context.fillRect(0, 0, rulLength, rulThickness);\n    \n    // Calculate pixels per unit based on the ruler scale\n    const pxPerMmLocal = options.dpi / 25.4;\n    const pxPerCmLocal = pxPerMmLocal * 10;\n    \n    // Determine the unit to use\n    const useUnit = options.unit || 'cm';\n    const pixelsPerUnit = useUnit === 'cm' ? pxPerCmLocal : (useUnit === 'mm' ? pxPerMmLocal : 1);\n    \n    // Adjust for the canvas width multiplication (ruler.js multiplies by 4)\n    const adjustedPixelsPerUnit = pixelsPerUnit / rulScale;\n    \n    // Calculate the zero point (center of the ruler canvas)\n    const zeroPoint = rulLength / 2;\n    \n    // Calculate how many units fit to the left and right of zero\n    const unitsLeft = Math.ceil(zeroPoint / adjustedPixelsPerUnit);\n    const unitsRight = Math.ceil((rulLength - zeroPoint) / adjustedPixelsPerUnit);\n    \n    console.log('Ruler calculations:', { pixelsPerUnit, adjustedPixelsPerUnit, zeroPoint, unitsLeft, unitsRight });\n    \n    // Define tick heights matching the reference image\n    const tickHeights = {\n        major: rulThickness - 3,       // Full height for major marks\n        medium: (rulThickness - 3) * 0.6,    // 60% height for half units\n        minor: (rulThickness - 3) * 0.4      // 40% height for minor marks\n    };\n    \n    // Draw tick marks\n    context.strokeStyle = '#000000';\n    context.lineWidth = 1;\n    context.beginPath();\n    \n    // Draw the ruler marks from negative to positive\n    for (let i = -unitsLeft; i <= unitsRight; i++) {\n        const x = Math.round(zeroPoint + (i * adjustedPixelsPerUnit));\n        \n        if (x < 0 || x > rulLength) continue;\n        \n        // Draw major tick mark\n        context.moveTo(x + 0.5, 0);\n        context.lineTo(x + 0.5, tickHeights.major);\n        \n        // Draw subdivision marks\n        if (i < unitsRight) {\n            const subdivisions = useUnit === 'cm' ? 10 : (useUnit === 'mm' ? 10 : 50);\n            \n            for (let j = 1; j < subdivisions; j++) {\n                const subX = Math.round(x + (j * adjustedPixelsPerUnit / subdivisions));\n                \n                if (subX < 0 || subX > rulLength) continue;\n                \n                let tickHeight;\n                if (useUnit === 'cm' || useUnit === 'mm') {\n                    // For metric: 5mm/5 units gets medium tick, others get small tick\n                    tickHeight = (j === 5) ? tickHeights.medium : tickHeights.minor;\n                } else {\n                    // For pixels: every 25 gets medium, every 5 gets small\n                    if (j % 25 === 0) tickHeight = tickHeights.medium;\n                    else if (j % 5 === 0) tickHeight = tickHeights.minor;\n                    else continue;\n                }\n                \n                context.moveTo(subX + 0.5, 0);\n                context.lineTo(subX + 0.5, tickHeight);\n            }\n        }\n    }\n    \n    context.stroke();\n    \n    // Draw number labels (after stroke, so they're on top)\n    context.fillStyle = '#000000';\n    context.font = '10px Arial, sans-serif';\n    context.textAlign = 'center';\n    context.textBaseline = 'top';\n    \n    console.log('Drawing labels from', -unitsLeft, 'to', unitsRight);\n    for (let i = -unitsLeft; i <= unitsRight; i++) {\n        const x = Math.round(zeroPoint + (i * adjustedPixelsPerUnit));\n        if (x < 0 || x > rulLength) continue;\n        const y = tickHeights.major + 2;\n        if (Math.abs(i) <= 3) console.log(`Drawing label \"${i}\" at x:${x}, y:${y}`);\n        context.fillText(i.toString(), x, y);\n    }\n};\n\n\n","import Ruler from './ruler';\n\nexport default (editor, opts = {}) => {\n    const options = {\n        ...{\n            // default options\n            dragMode: 'translate',\n            rulerHeight: 15,\n            canvasZoom: 94,\n            rulerOpts: {\n                unit: 'mm',\n                dpi: 96\n            },\n        },\n        ...opts\n    };\n\n    const cm = editor.Commands;\n    const rulH = options.rulerHeight;\n    const defaultDragMode = editor.getConfig('dragMode');\n    let zoom = options.canvasZoom\n    let scale = 100 / zoom;\n    // Save original setZoom to restore later\n    let _origSetZoom = null;\n    let _zoomHandler = null;\n    let _zoomChangeHandler = null;\n    let rulers;\n\n    cm.add('ruler-visibility', {\n        run(editor) {\n            !rulers && (rulers = new Ruler({\n                container: editor.Canvas.getCanvasView().el,\n                canvas: editor.Canvas.getFrameEl(),\n                rulerHeight: rulH,\n                strokeStyle: 'white',\n                fillStyle: 'white',\n                cornerIcon: 'fa fa-trash',\n                ...options.rulerOpts\n            })) && editor.on('canvasScroll frame:scroll change:canvasOffset', () => {\n                setOffset();\n            });\n            editor.Rulers = rulers;\n            rulers.api.toggleRulerVisibility(true);\n            editor.Canvas.setZoom(zoom);\n            editor.setDragMode(options.dragMode);\n            setOffset();\n            rulers.api.setScale(scale);\n\n            // Override Canvas.setZoom so rulers update automatically\n            if (!_origSetZoom && editor.Canvas && typeof editor.Canvas.setZoom === 'function') {\n                _origSetZoom = editor.Canvas.setZoom.bind(editor.Canvas);\n                editor.Canvas.setZoom = function (newZoom) {\n                    // call original\n                    const out = _origSetZoom(newZoom);\n                    try {\n                        zoom = newZoom || editor.Canvas.getZoom();\n                        scale = 100 / zoom;\n                        // update offsets and rulers\n                        setOffset();\n                        rulers && rulers.api.setScale(scale);\n                    } catch (err) {\n                        // ignore - should not crash editor on error\n                        console.warn('grapesjs-rulers: failed to update rulers on zoom', err);\n                    }\n                    return out;\n                }\n            }\n\n            // Also listen to canvas zoom events if present\n            _zoomHandler = () => {\n                try {\n                    zoom = editor.Canvas.getZoom();\n                    scale = 100 / zoom;\n                    setOffset();\n                    rulers && rulers.api.setScale(scale);\n                } catch (err) {}\n            };\n            editor.on('canvas:zoom', _zoomHandler);\n            _zoomChangeHandler = () => {\n                try {\n                    zoom = editor.Canvas.getZoom();\n                    scale = 100 / zoom;\n                    setOffset();\n                    rulers && rulers.api.setScale(scale);\n                } catch (err) {}\n            };\n            editor.on('change:canvasZoom', _zoomChangeHandler);\n        },\n        stop(editor) {\n            rulers && rulers.api.toggleRulerVisibility(false);\n            editor.Canvas.setZoom(100);\n            editor.setDragMode(defaultDragMode);\n            // restore original Canvas.setZoom if we replaced it\n            if (_origSetZoom && editor.Canvas) {\n                editor.Canvas.setZoom = _origSetZoom;\n                _origSetZoom = null;\n            }\n            if (_zoomHandler) {\n                editor.off('canvas:zoom', _zoomHandler);\n                _zoomHandler = null;\n            }\n            if (_zoomChangeHandler) {\n                editor.off('change:canvasZoom', _zoomChangeHandler);\n                _zoomChangeHandler = null;\n            }\n        }\n    });\n\n    const setOffset = () => {\n        const { top, left } = editor.Canvas.getOffset();\n        const scrollX = editor.Canvas.getBody().scrollLeft;\n        const scrollY = editor.Canvas.getBody().scrollTop;\n        rulers.api.setPos({\n            x: left - rulH - scrollX / scale,\n            y: top - rulH - scrollY / scale\n        });\n        rulers.api.setScroll({\n            x: scrollX,\n            y: scrollY\n        });\n    }\n\n    cm.add('guides-visibility', {\n        run() {\n            rulers && rulers.api.toggleGuideVisibility(true);\n        },\n        stop() {\n            rulers && rulers.api.toggleGuideVisibility(false);\n        }\n    });\n\n    cm.add('get-rulers', () => {\n        return rulers;\n    });\n\n    cm.add('get-rulers-constructor', () => {\n        return Ruler;\n    });\n\n    cm.add('clear-guides', () => {\n        rulers && rulers.api.clearGuides();\n    });\n\n    cm.add('get-guides', () => {\n        if (rulers) return rulers.api.getGuides();\n        else return 0;\n    });\n\n    cm.add('set-guides', (editor, sender, options = {}) => {\n        rulers && options.guides && rulers.api.setGuides(options.guides);\n    });\n\n    cm.add('set-zoom', (editor, sender, options = {}) => {\n        zoom = options.zoom;\n        scale = 100 / zoom;\n        editor.Canvas.setZoom(zoom);\n        setOffset();\n        rulers && rulers.api.setScale(scale);\n    });\n\n    cm.add('destroy-ruler', () => {\n        rulers && rulers.api.destroy();\n    });\n};"],"names":["root","factory","exports","module","define","amd","globalThis","window","this","__webpack_require__","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","Symbol","toStringTag","value","_typeof","iterator","constructor","toPropertyKey","t","i","r","e","toPrimitive","TypeError","String","Number","_defineProperty","configurable","writable","Ruler","options","arguments","length","undefined","api","builder","utils","canvasPointerEvents","canvas","style","pointerEvents","constructRulers","VERTICAL","HORIZONTAL","CUR_DELTA_X","CUR_DELTA_Y","SCROLL_X","SCROLL_Y","CUR_SCALE","rulerz","guides","theRulerDOM","document","createElement","corners","defaultOptions","rulerHeight","fontFamily","fontSize","strokeStyle","sides","cornerSides","lineWidth","enableMouseTracking","enableToolTip","unit","dpi","rotateRuler","curRuler","angle","rotation","origin","pixelize","Math","abs","parseInt","left","webkitTransform","MozTransform","OTransform","msTransform","transform","webkitTransformOrigin","MozTransformOrigin","OTransformOrigin","msTransformOrigin","transformOrigin","positionRuler","alignment","width","height","orgPos","top","constructGuide","dimension","x","y","isSet","guideIndex","guide","guideStyle","curDelta","title","dataset","id","addClasss","appendChild","container","getBoundingClientRect","round","push","line","guideLine","querySelector","coor","assigned","some","index","destroy","splice","constructRuler","rulerStyle","element","rulerConstructor","drawRuler","offsetWidth","attachListeners","curRul","mousedown","clientX","clientY","addEventListener","clearListeners","removeEventListener","constructCorner","cornerDraw","side","corner","cornerStyle","toUpperCase","cornerIcon","lineHeight","stopPropagation","clearGuides","forEach","parentNode","removeChild","mouseup","stopDrag","forEachRuler","cb","rul","getPos","setPos","values","orgY","orgX","deltaX","deltaY","curPosDelta","setScroll","setScale","newScale","curPos","orgDelta","curScaleFac","context","clearRect","beginPath","stroke","parseFloat","curScale","removeGuide","last","pop","getGuides","map","posX","posY","setGuides","_guides","curOptions","extend","toggleRulerVisibility","val","state","display","trackers","querySelectorAll","toggleGuideVisibility","func","ruler","_canvas","rulDimension","getContext","rulThickness","rulLength","rulScale","tracker","getScale","drawPoints","console","log","fillStyle","fillRect","pxPerMmLocal","pxPerCmLocal","useUnit","pixelsPerUnit","adjustedPixelsPerUnit","zeroPoint","unitsLeft","ceil","unitsRight","tickHeights","major","medium","minor","moveTo","lineTo","subdivisions","j","subX","tickHeight","font","textAlign","textBaseline","concat","fillText","toString","drawPointsUtil","mousemove","target","tagName","zoom","initTracker","getLength","getThickness","_rulerLength","_rulerThickness","_rulerScale","_dragContainer","lineDimension","movecb","event","scale","self","_curScale","_assigned","_curPosDelta","dragContainer","moveCB","draggable","cv","move","xpos","ypos","updateToolTip","startMoving","evt","divTop","divLeft","eWi","eHe","offsetHeight","cWi","cHe","cursor","diffX","diffY","onmousemove","aX","aY","showToolTip","stopMoving","removeClasss","formatUnitLocal","px","toFixed","replace","pxValue","tip","dblclick","setTimeout","setAsDraggable","startDrag","hide","show","prependChild","insertBefore","firstChild","classNames","Array","name","className","curCalsss","editor","opts","_objectSpread","dragMode","canvasZoom","rulerOpts","cm","Commands","rulH","defaultDragMode","getConfig","rulers","_origSetZoom","_zoomHandler","_zoomChangeHandler","add","run","Canvas","getCanvasView","el","getFrameEl","on","setOffset","Rulers","setZoom","setDragMode","bind","newZoom","out","getZoom","err","warn","stop","off","getOffset","scrollX","getBody","scrollLeft","scrollY","scrollTop","sender"],"sourceRoot":""}